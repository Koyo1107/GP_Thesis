\chapter{実験}
ここでは本研究において行った実験について述べる.

\section{さまざまな状況におけるDepth2Jamの推定精度実験}
\label{sec:exp1}
実装と予備実験の項で述べた実験を通してシステムをさらに改良し,さまざまな状況下のドライブレコーダー映像を使ってDepth2Jamの推定精度を測定する実験を行った.
これまでの実験に用いたデーターセットはどれも前方に先行車があるという状況だったが,この実験では先行車がない映像や信号で停止している映像を用いてDepth2Jamの推定精度に関して実験評価を行う.
実験3を行うにあたって人間の目で渋滞しているフレーム数を数える必要があるため,システムにおいて出力された映像の中央にフレーム数を明記されるように改良した.
また,本実験においては人間の目で渋滞を判断するにあたって,信号等の要素を排除し,車間距離が近いと感じられる,あるいは車道において先行車が停止し,停止ランプがついており,ドライブレコーダーが取り付けられている自動車も停車している状況を渋滞と判断した.
%
%そのうえで,この実験が提案手法を評価する上で十分なのか,もう少し検討しましょう.
%少なくとも,各動画の渋滞状況をground truthとして示し,システムでの検出結果を示し,それらを比較する必要があります.
%これに加えて,全く渋滞していない,少し流れが悪い,断続的に渋滞,全く動いていない,みたいに,いろいろな状況の動画での実験が必要と思います.
%
%

\subsection{使用したデータセット}
本実験において使用したデータセットを以下の表に示す.

% ----------------------------------------------------
\begin{table}[htbp]
  \centering
  \begin{scriptsize}
  \begin{tabular}{cccccc}
  \toprule
映像番号 & 映像の内容 & 映像時間 & フレーム数 & 時間帯 & 道路 \\
  \midrule
映像1 & 全く渋滞していない & 60秒 & 1830フレーム & 昼 & 一般道 \\
映像2 & 先行車あり スムーズに進んでいる & 60秒 & 1830フレーム & 昼 & 一般道 \\
映像3 & 途中信号による停車あり & 60秒 & 1830フレーム & 昼 & 一般道 \\
映像4 & 渋滞中の継続的な渋滞 & 60秒 & 1830フレーム & 昼 & 一般道 \\
映像5 & 信号による停車 & 31秒& 928フレーム & 昼 & 一般道 \\
  \bottomrule
  \end{tabular}
  \end{scriptsize}
  \caption{実験 データーセット}
  \label{tab:exp_dataset3}
\end{table}
% ------------------------------------------------------

\subsection{結果}
データセットで述べたドライブレコーダー映像においてシステムが出力した結果および人間の判断の結果を\tabref{tab:exp3_fig}に示す.
この結果におけるGround Truthとは先述における基準をもとに人間が渋滞だと判断したフレーム数のことである.
\tabref{tab:exp3_fig}の通り,映像1の結果は先行車がなく,全く渋滞していないドライブレコーダー映像であり,システム出力結果においても渋滞の誤検出はなかった.
それに対して,映像2においては,先行車ありではあるが止まることなくスムーズに進んでいる自動車のドライブレコーダー映像である.
スムーズに進んでいても,4フレームにおいて渋滞だと誤検出するケースが発生した.
映像3~5に関してはどの映像においてもGround Truthに対してシステムの渋滞推定フレーム数は少なくなっている.
% ----------------------------------------------------
\begin{table}[htbp]
  \centering
  \begin{scriptsize}
  \begin{tabular}{cccc}
  \toprule
映像番号 & 映像の内容 & システムの渋滞推定フレーム数(a) & Ground Truth(b)\\
  \midrule
映像1 & 先行車なし 無渋滞 & 0 & 0 \\
映像2 & 先行車あり スムーズに進んでいる & 4 & 0 \\
映像3 & 途中信号による停車あり & 167 & 870\\
映像4 & 渋滞中の継続的な渋滞 & 130 & 452\\
映像5 & 信号による停車 & 251 & 927 \\
\bottomrule
\end{tabular}
\end{scriptsize}
  \caption{実験結果 - 各動画のフレームごとの比較}
  \label{tab:exp3_fig}
\end{table}
% ------------------------------------------------------

\section{Depth2Jamの精度評価実験}
\label{sec:exp2}
Depth2Jamにおける再現性,適合率及びmAP値を測定するための実験を行った.
実験にて出力された映像データー５つから,それぞれ20フレームずつ抽出し,合計100フレーム画像において,Depth2Jamの渋滞判断においてさまざまな指標における結果を\figref{tab:mAP_fig}に示す.
表における総合とは,それぞれの映像から合計20フレーム画像ずつ抽出,,合計100画像となったテストデーターを指す.
また,TP,FP,FN,TNのそれぞれの説明および評価指標の説明を以下に示す.

\begin{itemize}
  \item TP : システムが渋滞だと判断し,実際に渋滞しているフレーム
  \item FP : システムが渋滞だと判断したが,実際には渋滞していないフレーム
  \item FN : システムが渋滞ではないと判断したが,実際には渋滞していたフレーム
  \item TN : システムが渋滞でないと判断し,実際に渋滞していないフレーム
\end{itemize}
% ----------------------------------------------------
\begin{table}[htbp]
  \centering
  \begin{scriptsize}
  \begin{tabular}{cccccccccc}
  \toprule
映像 & TP & FP & FN & TN & 正解率(Accuracy) & 適合率(Precision) & 再現率(Recall) & 特異度(Specificity) & F値(F-measure) \\
  \midrule
映像1 & 0 & 0 & 0 & 100 & 1 & 0 & 0 & 1 & 0 \\
映像2 & 0 & 0 & 0 & 100 & 1 & 0 & 0 & 1 & 0 \\
映像3 & 7 & 0 & 43 & 50 & 0.57 & 1 & 0.14 & 1 & 0.25 \\
映像4 & 4 & 0 & 29 & 67 & 0.71 & 1 & 0.12 & 1 & 0.22 \\
映像5 & 26 & 0 & 74 & 0 & 0.26 & 1 & 0.26 & 1 & 0.33 \\
総合 & 5 & 0 & 31 & 64 & 0.69 & 1 & 0.14 & 1 & 0.24 \\
\bottomrule
\end{tabular}
\end{scriptsize}
  \caption{それぞれの映像における精度}
  \label{tab:mAP_fig}
\end{table}
% ------------------------------------------------------

加えて,比較対象として,画面全面の自動車類を検出した場合の結果を\tabref{tab:mAP_fig_noweght}に示す.

% ----------------------------------------------------
\begin{table}[htbp]
  \centering
  \begin{scriptsize}
  \begin{tabular}{cccccccccc}
  \toprule
映像 & TP & FP & FN & TN & 正解率(Accuracy) & 適合率(Precision) & 再現率(Recall) &　特異度(Specificity) & F値(F-measure) \\
  \midrule
映像1 & 0 & 8 & 0 & 92 & 0.92 & 0 & 0 & 0.92 & 0 \\
映像2 & 0 & 29 & 0 & 71 & 0.71 & 0 & 0 & 0.71 & 0 \\
映像3 & 10 & 5 & 43 & 42 & 0.52 & 0.33 & 0.19 & 0.89 & 0.24 \\
映像4 & 7 & 15 & 29 & 49 & 0.56 & 0.32 & 0.19 & 0.77 & 0.24 \\
映像5 & 69 & 0 & 31 & 0 & 0.69 & 1 & 0.69 & 0 & 0.82 \\
総合 & 11 & 10 & 15 & 64 & 0.75 & 0.52 & 0.42 & 0.86 & 0.46 \\
\bottomrule
\end{tabular}
\end{scriptsize}
  \caption{画面全体を検出した場合の精度}
  \label{tab:mAP_fig_noweght}
\end{table}
% ------------------------------------------------------

\section{評価}
本研究では,実装したシステムの精度を評価するにあたってF値を用いる.
F値とは,再現率と適合率の調和平均の値であり,渋滞している/していないのような混合行列となるシステムの評価に適しているものである.
\tabref{tab:mAP_fig}の表の通り,映像1および映像2において渋滞していると判断できるフレームは存在しないのでF値は0となっているが,映像3~5及び総合フレームにおいては0.22~0.33という結果になった.
正解率をみると0.26~1とばらつきがあるものの,F値が0.2付近にあるため,本研究において実装したシステムはまだまだ実用化へは遠く,性能向上が必要であると評価される.
